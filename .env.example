# Eve Retell WS Brain - canonical environment template (DO NOT COMMIT REAL SECRETS)
#
# Bootstrap:
#   cp .env.example .env
#   # then fill required values before any live calls
#
# Notes:
# - `docker-compose.yml` uses this file as the runtime env source (`env_file: .env`)
# - `scripts/cloudflare_verify.sh` reads `.env.cloudflare.local` by default, so copy the
#   Cloudflare keys there as well (or export them in your shell) when running the verifier.

############################
# Runtime / compose defaults
############################
LOG_LEVEL=INFO
UVICORN_WORKERS=2
EVE_BRAIN_HOST_PORT=8080

############################
# Retell outbound brain (required for live calling)
############################
RETELL_API_KEY=your_retell_api_key_here
RETELL_FROM_NUMBER=+15555550100
B2B_AGENT_ID=your_b2b_agent_id_here
B2B_OUTBOUND_AGENT_ID=
BRAIN_WSS_BASE_URL=wss://voice-agent.evesystems.org/llm-websocket

# Retell agent tuning (sent on WS connect)
RETELL_AUTO_RECONNECT=true
RETELL_CALL_DETAILS=true
RETELL_TRANSCRIPT_WITH_TOOL_CALLS=true
RETELL_SEND_UPDATE_AGENT_ON_CONNECT=true
RETELL_RESPONSIVENESS=0.5
RETELL_INTERRUPTION_SENSITIVITY=0.5
RETELL_NORMALIZE_FOR_SPEECH=false
RETELL_REMINDER_TRIGGER_MS=3000
RETELL_REMINDER_MAX_COUNT=1

############################
# LLM provider (production default: Gemini)
############################
BRAIN_USE_LLM_NLG=true
LLM_PROVIDER=gemini
LLM_PHRASING_FOR_FACTS_ENABLED=false
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-3-flash-preview
GEMINI_THINKING_LEVEL=minimal
GEMINI_VERTEXAI=false
GEMINI_PROJECT=
GEMINI_LOCATION=global

############################
# Optional alternate LLM provider (OpenAI)
############################
OPENAI_API_KEY=
OPENAI_MODEL=gpt-5-mini
OPENAI_REASONING_EFFORT=minimal
OPENAI_TIMEOUT_MS=8000
OPENAI_CANARY_ENABLED=false
OPENAI_CANARY_PERCENT=0

############################
# Supabase / n8n funnel integrations
############################
SUPABASE_URL=
SUPABASE_SERVICE_KEY=
SUPABASE_SCHEMA=public
SUPABASE_CONNECTION_STRING=
N8N_LEAD_WEBHOOK_URL=
N8N_OUTCOME_WEBHOOK_URL=
N8N_API_KEY=
N8N_B2B_OUTCOME_WORKFLOW=B2B Outbound Outcome Hub
N8N_B2B_OUTCOME_WEBHOOK=https://elijah-wallis.app.n8n.cloud/webhook/openclaw-retell-fn-outcome-hub
OWNER_ALERT_WEBHOOK_URL=

############################
# Twilio (n8n / script integrations)
############################
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_API_KEY_SID=
TWILIO_API_KEY_SECRET=

############################
# Cloudflare tunnel / verification
############################
CLOUDFLARE_ACCOUNT_ID=your_cloudflare_account_id_here
CLOUDFLARE_EVE_TOC_BUILD_API_TOKEN=your_cloudflare_api_token_here
CLOUDFLARE_TUNNEL_HOSTNAME=voice-agent.evesystems.org
CLOUDFLARE_TUNNEL_ORIGIN_PORT=8080

############################
# WebSocket hardening (recommended in prod)
############################
WS_WRITE_TIMEOUT_MS=400
WS_CLOSE_ON_WRITE_TIMEOUT=true
WS_MAX_CONSECUTIVE_WRITE_TIMEOUTS=2
WS_MAX_FRAME_BYTES=262144
WS_ALLOWLIST_ENABLED=false
WS_ALLOWLIST_CIDRS=
WS_TRUSTED_PROXY_ENABLED=false
WS_TRUSTED_PROXY_CIDRS=
WS_SHARED_SECRET_ENABLED=false
WS_SHARED_SECRET=
WS_SHARED_SECRET_HEADER=X-RETELL-SIGNATURE
WS_QUERY_TOKEN=
WS_QUERY_TOKEN_PARAM=token

############################
# WebSocket routing / logging
############################
WEBSOCKET_CANONICAL_ROUTE=llm-websocket
WEBSOCKET_ENFORCE_CANONICAL_ROUTE=true
WEBSOCKET_STRUCTURED_LOGGING=false

############################
# Brain core behavior
############################
BRAIN_SPEAK_FIRST=true
BRAIN_BACKCHANNEL_ENABLED=false
BRAIN_INBOUND_QUEUE_MAX=256
BRAIN_OUTBOUND_QUEUE_MAX=256
BRAIN_TURN_QUEUE_MAX=64
BRAIN_IDLE_TIMEOUT_MS=5000
BRAIN_PING_INTERVAL_MS=2000
KEEPALIVE_PING_WRITE_DEADLINE_MS=100

############################
# VIC timing / stability thresholds
############################
VIC_ACK_DEADLINE_MS=250
VIC_TOOL_TIMEOUT_MS=1500
VIC_MODEL_TIMEOUT_MS=3800
VIC_TOOL_FILLER_THRESHOLD_MS=800
VIC_MODEL_FILLER_THRESHOLD_MS=800
VIC_MAX_FILLERS_PER_TOOL=1
VIC_MAX_SEGMENT_EXPECTED_MS=650
VIC_MAX_MONOLOGUE_EXPECTED_MS=12000
VIC_MAX_REPROMPTS=2
VIC_BARGE_IN_CANCEL_P95_MS=250

############################
# Speech pacing / markup
############################
SPEECH_MARKUP_MODE=DASH_PAUSE
DASH_PAUSE_SCOPE=PROTECTED_ONLY
DASH_PAUSE_UNIT_MS=200
DIGIT_DASH_PAUSE_UNIT_MS=150
PACE_MS_PER_CHAR=12
TRANSCRIPT_MAX_UTTERANCES=200
TRANSCRIPT_MAX_CHARS=50000

############################
# Conversation profile / persona
############################
CONVERSATION_PROFILE=b2b
CLINIC_NAME=Clinic
CLINIC_CITY=Plano
CLINIC_STATE=Texas
B2B_AGENT_NAME=Cassidy
B2B_ORG_NAME=Eve
B2B_AUTO_DISCLOSURE=false
B2B_BUSINESS_NAME=Clinic
B2B_CITY=Plano
B2B_TEST_TIMESTAMP=Saturday at 6:30 PM
B2B_EVIDENCE_TYPE=AUDIO
B2B_EMR_SYSTEM=Zenoti, Boulevard, or MangoMint
B2B_CONTACT_NUMBER=+14695998571

############################
# Eve v7 orchestrator
############################
EVE_V7_ENABLED=true
EVE_V7_SCRIPT_PATH=orchestration/eve-v7-orchestrator.yaml

############################
# Voice quality guardrails
############################
VOICE_PLAIN_LANGUAGE_MODE=true
VOICE_NO_REASONING_LEAK=true
VOICE_JARGON_BLOCKLIST_ENABLED=true

############################
# Skills runtime (default OFF)
############################
SKILLS_ENABLED=false
SKILLS_DIR=skills
SKILLS_MAX_INJECTED=3

############################
# Shell runtime policy (default local-only; hosted OFF)
############################
SHELL_MODE=local
SHELL_ENABLE_HOSTED=false
SHELL_ALLOWED_COMMANDS=
SHELL_TOOL_ENABLED=false
SHELL_TOOL_CANARY_ENABLED=false
SHELL_TOOL_CANARY_PERCENT=0

############################
# Self-improvement (default OFF)
############################
SELF_IMPROVE_MODE=off

############################
# Speculative planning
############################
SPECULATIVE_PLANNING_ENABLED=true
SPECULATIVE_DEBOUNCE_MS=0
SPECULATIVE_TOOL_PREFETCH_ENABLED=true
SPECULATIVE_TOOL_PREFETCH_TIMEOUT_MS=100

############################
# Outbound launcher / dashboard controls
############################
LIVE_MAX_CALLS=5
LIVE_CONCURRENCY=5
LIVE_DISPATCH_CONTROL_FILE=data/leads/.live_dispatch_controls.json
LIVE_CAMPAIGN_ID=ont-live-001
LIVE_TENANT=live_medspa

############################
# Apify lead sourcing (optional)
############################
APIFY_API_TOKEN=
APIFY_ACTOR_ID=compass/crawler-google-places

############################
# Dogfood / testing helpers
############################
DOGFOOD_TO_NUMBER=+15555550199
